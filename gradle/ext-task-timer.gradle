/*
*	Copyright 2015 rockit.consulting GbR  (www.rockit.consulting)
*
*/

import org.gradle.logging.StyledTextOutput;
import org.gradle.logging.StyledTextOutputFactory;
import static org.gradle.logging.StyledTextOutput.Style;


class TaskTimerListener implements TaskExecutionListener {

    private Clock clock
    def out
    
    public TaskTimerListener (services) {
    	out = services.get(StyledTextOutputFactory).create("coloredFactory")
    
    }    

    @Override
    void beforeExecute(Task task) {
        clock = new org.gradle.util.Clock()
    }

    @Override
    void afterExecute(Task task, TaskState taskState) {
        task.project.logger.info "Execution of ${task.name} took ${clock.time}"
        out.withStyle(Style.Info).println("Execution of [:${task.name}] took ${clock.time}")
    }
}

gradle.addListener new TaskTimerListener(getServices())